<ion-header>
  <ion-toolbar>
    <ion-title>
      {{'TITOLO_HOME' | translate}}
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <!-- Categorie -->
  <ion-title style="margin-top: 10px">{{'TITOLO_CATEGORIE' | translate}}</ion-title>
      <ion-grid fixed>
        <ion-row>
          <ion-col size="12">
            <ion-segment scrollable>
              <ion-segment-button class="horizontalScroll" (click)="onCategoryClick(categoria.id)"
                                  *ngFor="let categoria of categorie$ | async">
                <ion-label>{{categoria.nome}}</ion-label>
              </ion-segment-button>
            </ion-segment>
          </ion-col>
        </ion-row>
      </ion-grid>

  <!-- Top CittÃ  -->
  <ion-title>{{'TITOLO_TOP_CITTA' | translate}}</ion-title>
    <ion-grid fixed>
      <ion-row>
        <ion-col size="12">
          <ion-segment scrollable>
            <ion-segment-button class="horizontalScroll" *ngFor="let city of cities" value="{{city}}"
                                (click)="onCityClick(city)">
              <ion-label>{{city}}</ion-label>
            </ion-segment-button>
          </ion-segment>
        </ion-col>
      </ion-row>
    </ion-grid>

  <!-- Nei Dintorni -->
  <ion-title><ion-label>{{'TITOLO_NEI_DINTORNI' | translate}}</ion-label>
  <ion-label text-center style="font-size: medium" (click)="showMore()" float-end color="tertiary">ALTRO</ion-label>
  </ion-title>


    <!--<ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
      <ion-refresher-content></ion-refresher-content>
    </ion-refresher>-->

  <ion-list>

    <!-- Crescent -->
    <ion-label *ngIf="!loaded">
      <ion-spinner name="crescent"></ion-spinner>
    </ion-label>

    <ion-card *ngFor="let ristorante of ristoranti$ | async | slice:0:10" [routerLink]="['dettagli-ristorante', ristorante.id]" routerDirection="forward">
      <ion-row>
        <ion-col>
          <ion-img src='data:image/jpeg;base64, {{ristorante.immagini[0].file}}' ></ion-img>
        </ion-col>
      </ion-row>

      <ion-card-title class="ion-margin-top">
        <ion-row>
          <ion-col>
            <ion-label class=" ion-margin-start ion-float-left">
              {{ristorante.nome}}
            </ion-label>
          </ion-col>
          <ion-col>
            <ion-label *ngIf="!ristorante.recensioni.length < 1" class="ion-margin-end ion-float-end" color="tertiary">
              {{calcolaMedie(ristorante.recensioni)}} <ion-label style="font-size: small; color: #989aa2">/10</ion-label>
            </ion-label>
          </ion-col>
        </ion-row>
      </ion-card-title>

      <ion-badge class="ion-margin-start ion-margin-top" color="primary" *ngFor="let cate of ristorante.categorie"> {{cate.nome}}</ion-badge>

      <ion-card-content>

        <ion-row>
          <ion-col>
            <strong>{{ristorante.citta.nome}}</strong>, {{ristorante.indirizzo}}
          </ion-col>

          <ion-col>
            <ion-label *ngIf="ristorante.sconto > 0" class="ion-float-end" color="secondary">{{ristorante.sconto}}% di sconto!</ion-label>
          </ion-col>
        </ion-row>

      </ion-card-content>
    </ion-card>
  </ion-list>


</ion-content>
